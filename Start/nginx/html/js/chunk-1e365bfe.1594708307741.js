(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e365bfe"],{"0449":function(t,e,s){},"0e73":function(t,e,s){},1142:function(t,e,s){},1195:function(t,e,s){t.exports=s.p+"img/avatar.f1ca2b1e.png"},1509:function(t,e,s){"use strict";var i=s("9bf2"),n=s.n(i);n.a},"183f":function(t,e,s){"use strict";var i=s("51ee"),n=s.n(i);n.a},1903:function(t,e,s){"use strict";var i=s("bcce"),n=s.n(i);n.a},"23e7":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"breadcrumb"},[s("div",{staticClass:"menu"},[s("div",[s("svg-icon",{attrs:{"icon-class":"refresh"},on:{click:t.refresh}})],1),t._v(" "),s("p",[t._v("当前位置:")])]),t._v(" "),s("div",{staticClass:"main"},[s("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:"-"}},t._l(t.levelList,(function(e,i){return s("el-breadcrumb-item",{key:i},["noRedirect"===e.redirect||i==t.levelList.length-1?s("span",{staticClass:"no-redirect"},[t._v(t._s(e.name))]):s("span",{on:{click:function(s){return s.preventDefault(),t.handleLink(e)}}},[t._v(t._s(e.name))])])})),1)],1)])},n=[],a=[{key:"新房详情",levels:["门店工作台","房源管理","新房分销"]},{key:"房源详情",levels:["门店工作台","房源管理","房源买卖"]},{key:"录入房源",levels:["门店工作台","房源管理","房源买卖"]},{key:"小区详情",levels:["门店工作台","房源管理","小区广场"]},{key:"创建小区",levels:["门店工作台","房源管理","小区广场"]},{key:"成交详情",levels:["门店工作台","签约交易","新房报备/结佣"]},{key:"补录新房成交",levels:["门店工作台","签约交易","新房报备/结佣"]},{key:"补录佣金结算单",levels:["门店工作台","签约交易","新房报备/结佣"]},{key:"结佣详情",levels:["平台运管","交易中心","佣金结算管理"]},{key:"创建客户成交",levels:["平台运管","交易中心","客户成交中心"]},{key:"客户成交详情",levels:["平台运管","交易中心","客户成交中心"]},{key:"创建佣金结算",levels:["平台运管","交易中心","佣金结算管理"]},{key:"人事管理员工档案",levels:["平台运管","人事管理","员工管理"]},{key:"门店管理员工档案",levels:["门店工作台","门店管理","门店员工"]}];function r(t){return u(t)||l(t)||c(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"===typeof t)return v(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?v(t,e):void 0}}function l(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function u(t){if(Array.isArray(t))return v(t)}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var d={data:function(){return{levelList:null}},watch:{$route:function(t){t.path.startsWith("/redirect/")||this.getBreadcrumb()}},created:function(){this.getBreadcrumb()},methods:{refresh:function(){this.$root.$emit("refresh")},getBreadcrumb:function(){var t=this.$route,e=a.find((function(e){return e.key==t.name})),s=t.query.title||t.name;this.levelList=r(t.matched),e&&(this.levelList=e.levels.map((function(t){return{name:t}})),this.levelList.push({name:s})),(t.params.source||t.query.source)&&(this.levelList[this.levelList.length-1].name=t.params.source||t.query.source,this.levelList.push({name:s}));var i=this.levelList.length;t.query&&t.query.title&&(this.levelList[this.levelList.length-1].name=t.query.title),this.levelList[i-1].name==this.levelList[i-2].name&&(this.levelList[i-2].name==this.levelList[i-3].name&&this.levelList.pop(),this.levelList.pop())}}},f=d,h=(s("7ff8"),s("2877")),g=Object(h["a"])(f,i,n,!1,null,"6c3ed2e2",null);e["default"]=g.exports},"28d5":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tags-view-container"},[s("div",{staticClass:"tags-view-wrapper"},[t._l(t.visitedViews,(function(e,i){return s("router-link",{key:i,ref:"tag",refInFor:!0,staticClass:"tags-view-item",attrs:{to:{path:e.path,query:e.query,fullPath:e.fullPath},index:"",tag:"span"},nativeOn:{contextmenu:function(s){return s.preventDefault(),t.openMenu(e,s)}}},[s("div",{staticClass:"tags-view-item-main",class:t.isActive(e)?"active":""},[s("p",{staticClass:"title",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),"/home/home"!=e.path?s("div",{on:{click:function(s){return s.preventDefault(),s.stopPropagation(),t.closeSelectedTag(e)}}},[s("el-icon",{staticClass:"el-icon-close",attrs:{type:"close"}})],1):t._e()]),t._v(" "),s("div",{staticClass:"triangle_border_nw",class:t.isActive(e)?"active":""})])})),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:t.left+"px",top:t.top+"px"}},[t.selectedTag.path==t.$route.path?s("li",{on:{click:function(e){return t.$root.$emit("refresh")}}},[t._v("\n        刷新页面\n      ")]):t._e(),t._v(" "),s("li",{on:{click:function(e){return t.closeSelectedTag(t.selectedTag)}}},[t._v("关闭")]),t._v(" "),s("li",{on:{click:t.closeOthersTags}},[t._v("关闭其他标签页")])])],2)])},n=[],a={data:function(){return{visible:!1,top:0,left:0,selectedTag:{}}},computed:{visitedViews:function(){return this.$store.state.tagsView.visitedViews}},watch:{$route:function(){this.addTags()},visible:function(t){t?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},mounted:function(){this.addTags()},methods:{isActive:function(t){return t.path===this.$route.path},addTags:function(){var t=this.$route.name;return t&&this.$store.dispatch("tagsView/addView",this.$route),!1},closeSelectedTag:function(t){var e=this,s=function(){e.$store.dispatch("tagsView/delView",t).then((function(s){var i=s.visitedViews;e.isActive(t)&&e.toLastView(i)}))};if(1!=this.visitedViews.length)if(this.$route.fullPath==t.fullPath){var i=/(创建|录入|发起|编辑|补录)/g;-1!=t.name.search(i)?this.$confirm("关闭此标签会清空本页所有的表单数据, 是否继续?","提示",{type:"warning"}).then((function(){s()})).catch((function(){})):s()}else s();else this.$showError("已经是最后一页，无法关闭")},closeOthersTags:function(){this.$router.push(this.selectedTag),this.$store.commit("tagsView/SET_VIEW",[this.selectedTag])},toLastView:function(t){var e=t.slice(-1)[0];this.$navigateTo(e.fullPath,!1)},openMenu:function(t,e){var s=105,i=150,n=this.$el.offsetWidth,a=n-s,r=e.clientX-i+15;this.left=r>a?a:r,this.top=e.clientY-50,this.visible=!0,this.selectedTag=t},closeMenu:function(){this.visible=!1}}},r=a,o=(s("3ac9"),s("2877")),c=Object(o["a"])(r,i,n,!1,null,"04108d56",null);e["default"]=c.exports},"29e1":function(t,e,s){"use strict";var i=s("5185"),n=s.n(i);n.a},3362:function(t,e,s){"use strict";var i=s("c19f"),n=s.n(i);n.a},"3ac9":function(t,e,s){"use strict";var i=s("ddcd"),n=s.n(i);n.a},"3c5d":function(t,e,s){},"4b84":function(t,e,s){},5185:function(t,e,s){},"51ee":function(t,e,s){},"527f":function(t,e,s){"use strict";var i=s("9cc0"),n=s.n(i);n.a},"5e1f":function(t,e,s){"use strict";var i=s("d535"),n=s.n(i);n.a},6445:function(t,e,s){"use strict";var i=s("0449"),n=s.n(i);n.a},6733:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("my-header"),t._v(" "),s("div",{staticClass:"fm-content"},[t.isHide?t._e():s("tags-view"),t._v(" "),s("breadcrumb",{style:{top:t.isHide?"0":"30px"}}),t._v(" "),s("router-view"),t._v(" "),s("my-footer")],1),t._v(" "),s("image-viewer"),t._v(" "),s("house-type-preview")],1)},n=[],a=s("73a1"),r=s("28d5"),o=s("23e7"),c=s("9fe9"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.preview,expression:"preview"}]},[s("transition",{attrs:{name:"viewer-fade"}},[s("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":t.zIndex},attrs:{tabindex:"-1"}},[s("div",{staticClass:"el-image-viewer__mask"}),t._v(" "),s("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:t.hide}},[s("i",{staticClass:"el-icon-circle-close"})]),t._v(" "),t.isSingle?t._e():[s("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!t.infinite&&t.isFirst},on:{click:t.prev}},[s("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),s("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!t.infinite&&t.isLast},on:{click:t.next}},[s("i",{staticClass:"el-icon-arrow-right"})])],t._v(" "),s("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[s("div",{staticClass:"el-image-viewer__actions__inner"},[s("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return t.handleActions("zoomOut")}}}),t._v(" "),s("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return t.handleActions("zoomIn")}}}),t._v(" "),s("i",{staticClass:"el-image-viewer__actions__divider"}),t._v(" "),s("i",{class:t.mode.icon,on:{click:t.toggleMode}}),t._v(" "),s("i",{staticClass:"el-image-viewer__actions__divider"}),t._v(" "),s("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return t.handleActions("anticlocelise")}}}),t._v(" "),s("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return t.handleActions("clocelise")}}})])]),t._v(" "),s("div",{staticClass:"el-image-viewer__canvas"},t._l(t.urlList,(function(e,i){return s("img",{directives:[{name:"show",rawName:"v-show",value:i==t.index,expression:"i == index"}],key:e,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:t.imgStyle,attrs:{src:t.currentImg},on:{load:t.handleImgLoad,error:t.handleImgError,mousedown:t.handleMouseDown}})})),0)],2)])],1)},u=[],v=s("ed08");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var g={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},p="mousewheel",m={name:"elImageViewer",data:function(){return{zIndex:9999,preview:!1,index:0,isShow:!1,infinite:!0,loading:!1,mode:g.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},urlList:[]}},computed:{isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.urlList[this.index]},imgStyle:function(){var t=this.transform,e=t.scale,s=t.deg,i=t.offsetX,n=t.offsetY,a=t.enableTransition,r={transform:"scale(".concat(e,") rotate(").concat(s,"deg)"),transition:a?"transform .3s":"","margin-left":"".concat(i,"px"),"margin-top":"".concat(n,"px")};return this.mode===g.CONTAIN&&(r.maxWidth=r.maxHeight="100%"),r}},watch:{index:{handler:function(t){this.reset()}},currentImg:function(t){var e=this;this.$nextTick((function(t){if(e.$refs.img){var s=e.$refs.img[0];s.complete||(e.loading=!0)}else e.loading=!1}))}},created:function(){var t=this;this.$root.$off("showPreview"),this.$root.$on("showPreview",(function(e){var s=e.urlList,i=e.index,n=e.src;t.preview=!0,t.index=0===i?0:i||s.indexOf(n),t.urlList=s})),this.bindEvent()},methods:{bindEvent:function(){var t=this;document.addEventListener("click",(function(e){var s=e.target;if("preview"==s.getAttribute("type")&&s.getAttribute("resourceMap")){e.stopPropagation();var i=Number(s.getAttribute("index")),n=s.getAttribute("src"),a=s.getAttribute("resourceMap").split("||");i||(i=a.indexOf(n)>-1?a.indexOf(n):0),t.preview=!0,t.index=i,t.urlList=a}}),!0)},rafThrottle:function(t){var e=!1;return function(){for(var s=this,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];e||(e=!0,window.requestAnimationFrame((function(i){t.apply(s,n),e=!1})))}},hide:function(){this.deviceSupportUninstall(),this.preview=!1},deviceSupportInstall:function(){var t=this;this._keyDownHandler=this.rafThrottle((function(e){var s=e.keyCode;switch(s){case 27:t.hide();break;case 32:t.toggleMode();break;case 37:t.prev();break;case 38:t.handleActions("zoomIn");break;case 39:t.next();break;case 40:t.handleActions("zoomOut");break}})),this._mouseWheelHandler=this.rafThrottle((function(e){var s=e.wheelDelta?e.wheelDelta:-e.detail;s>0?t.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):t.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),Object(v["r"])(document,"keydown",this._keyDownHandler),Object(v["r"])(document,p,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(v["q"])(document,"keydown",this._keyDownHandler),Object(v["q"])(document,p,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(t){this.loading=!1},handleImgError:function(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown:function(t){var e=this;if(!this.loading&&0===t.button){var s=this.transform,i=s.offsetX,n=s.offsetY,a=t.pageX,r=t.pageY;this._dragHandler=this.rafThrottle((function(t){e.transform.offsetX=i+t.pageX-a,e.transform.offsetY=n+t.pageY-r})),Object(v["r"])(document,"mousemove",this._dragHandler),Object(v["r"])(document,"mouseup",(function(t){Object(v["q"])(document,"mousemove",e._dragHandler)})),t.preventDefault()}},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var t=Object.keys(g),e=Object.values(g),s=e.indexOf(this.mode),i=(s+1)%t.length;this.mode=g[t[i]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var t=this.urlList.length;this.index=(this.index-1+t)%t}},next:function(){if(!this.isLast||this.infinite){var t=this.urlList.length;this.index=(this.index+1)%t}},handleActions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var s=f({zoomRate:.2,rotateDeg:90,enableTransition:!0},e),i=s.zoomRate,n=s.rotateDeg,a=s.enableTransition,r=this.transform;switch(t){case"zoomOut":r.scale>.2&&(r.scale=parseFloat((r.scale-i).toFixed(3)));break;case"zoomIn":r.scale=parseFloat((r.scale+i).toFixed(3));break;case"clocelise":r.deg+=n;break;case"anticlocelise":r.deg-=n;break}r.enableTransition=a}}},mounted:function(){this.deviceSupportInstall(),this.$refs["el-image-viewer__wrapper"]&&this.$refs["el-image-viewer__wrapper"].focus()}},A=m,w=(s("bfdb"),s("2877")),_=Object(w["a"])(A,l,u,!1,null,"c420757c",null),b=_.exports,C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.previewFlag,expression:"previewFlag"}],staticClass:"preview"},[s("svg-icon",{staticClass:"close",attrs:{"icon-class":"close"},on:{click:function(e){t.previewFlag=!1}}}),t._v(" "),s("div",{staticClass:"box"},[s("div",{staticClass:"msg"},[s("div",{staticClass:"t"},[s("p",[t.imgInfo.openRoom?[t._v("开间 ")]:[t._v("\n            "+t._s(t.imgInfo.bedRoomQuantity)+"室"+t._s(t.imgInfo.livingRoomQuantity)+"厅"+t._s(t.imgInfo.restRoomQuantity)+"卫\n          ")],t._v(" "),s("span",[t._v("建面"+t._s(t.imgInfo.buildingArea)+"㎡")]),t._v("\n          "+t._s(t.imgInfo.orientation)+"\n        ")],2)]),t._v(" "),s("div",{staticClass:"b"},[s("p",[t._v(t._s(t.imgInfo.description))])])]),t._v(" "),s("div",{staticClass:"swiper"},[s("swiper",{ref:"mySwiper",staticClass:"swiper-no-swiping",staticStyle:{width:"100%",height:"100%"},attrs:{options:t.swiperOption}},[t.urlList?t._l(t.urlList,(function(t,e){return s("swiper-slide",{key:e},[s("div",{staticClass:"img"},[s("el-image",{attrs:{fit:"scale-down",src:t.houseTypeImagePaths[0]}})],1)])})):t._e()],2),t._v(" "),s("div",{staticClass:"btn",staticStyle:{left:"-80px"},on:{click:function(e){return e.stopPropagation(),t.slidePrev(e)}}},[s("svg-icon",{attrs:{"icon-class":"left"}})],1),t._v(" "),s("div",{staticClass:"btn",staticStyle:{right:"-80px"},on:{click:function(e){return e.stopPropagation(),t.slideNext(e)}}},[s("svg-icon",{attrs:{"icon-class":"right"}})],1)],1)])],1)},y=[],T=s("7212"),I={components:{swiper:T["swiper"],swiperSlide:T["swiperSlide"]},data:function(){return{previewFlag:!1,swiperOption:{slidesPerView:1,loop:!0},urlList:null,imgInfo:{}}},computed:{swiper:function(){return this.$refs.mySwiper.swiper}},mounted:function(){var t=this;this.$root.$off("showHouseTypePreview"),this.$root.$on("showHouseTypePreview",(function(e){var s=e.urlList,i=e.index;t.previewFlag=!0,t.$nextTick((function(){t.swiper.slideTo(i,1,!0),t.urlList=s,t.setImgInfo()}))}))},methods:{slidePrev:function(){this.swiper.slidePrev(),this.setImgInfo()},slideNext:function(){this.swiper.slideNext(),this.setImgInfo()},setImgInfo:function(){var t=this.swiper.activeIndex;this.imgInfo=this.urlList[t]}}},O=I,E=(s("9133"),Object(w["a"])(O,C,y,!1,null,"1a30339f",null)),L=E.exports,k={components:{Breadcrumb:o["default"],MyHeader:a["default"],MyFooter:c["a"],TagsView:r["default"],ImageViewer:b,HouseTypePreview:L},watch:{$route:function(){var t=document.querySelector(".sub-views");t&&(t.scrollTop=0)}},created:function(){document.title="".concat(this.$store.state.settings.userInfo.companyName||""," 领先的房地产经纪合伙人Saas系统")},computed:{isHide:function(){return"/enrollment"==this.$route.path}}},D=k,x=(s("183f"),Object(w["a"])(D,i,n,!1,null,null,null));e["default"]=x.exports},"73a1":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header",attrs:{id:"fm-header"}},[s("div",{staticClass:"l"},[s("el-image",{staticClass:"logo",attrs:{src:t.logo,fit:"contain"}},[s("img",{attrs:{slot:"error",src:t.logo},slot:"error"})])],1),t._v(" "),s("div",{staticClass:"c"},[t.isHide?t._e():t._l(t.dynamicMenu,(function(e,i){return s("div",{key:i,staticClass:"tab"},[s("transition",{attrs:{name:"fade"}},[e.name&&"/enrollment"!=e.path?s("div",{class:{active:-1!=t.$route.path.indexOf(e.path)},on:{click:function(e){return t.changeTab(i)}}},[s("p",[t._v(t._s(e.name))])]):t._e()])],1)}))],2),t._v(" "),s("div",{staticClass:"r"},[t.isHide||t.userInfo.isAdmin?t._e():s("div",{staticClass:"bell",class:{active:t.toggleNoticeDialog}},[s("svg-icon",{staticClass:"pointer",attrs:{"icon-class":"bell"},on:{click:function(e){return e.stopPropagation(),t.switchNoticeDialog(!0)}}}),t._v(" "),t.hasUnreadMsg?s("i",[t._v(t._s("number"==typeof t.hasUnreadMsg?t.hasUnreadMsg:""))]):t._e()],1),t._v(" "),t.isHide||t.userInfo.isAdmin?t._e():s("tabs-line"),t._v(" "),s("div",{staticClass:"user pointer"},[s("el-image",{staticClass:"img",attrs:{src:t.userImg,fit:"cover"}},[s("img",{attrs:{slot:"error",src:t.avatar},slot:"error"})]),t._v(" "),s("p",[t._v(t._s(t.userInfo.realName))])],1),t._v(" "),s("tabs-line"),t._v(" "),s("div",{staticClass:"pointer",on:{click:t.logout}},[t._v("注销登录")])],1),t._v(" "),s("el-drawer",{staticClass:"notice-drawer",attrs:{visible:t.toggleNoticeDialog,direction:"rtl"},on:{"update:visible":function(e){t.toggleNoticeDialog=e}}},[s("div",{staticClass:"notice-dialog",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"close",on:{click:t.switchNoticeDialog}},[s("i",{staticClass:"el-icon-close"})]),t._v(" "),s("div",{staticClass:"shortcut"},[t.toggleNoticeDialog?s("fm-notification",{attrs:{rowStyle:{padding:"20px"}}}):t._e()],1),t._v(" "),s("div",{staticClass:"msg-list"},["NOTIFY"==t.noticeActiveType?s("n-notice",{attrs:{msgType:"NOTIFY"},on:{closeDialog:t.switchNoticeDialog}}):t._e(),t._v(" "),"APPROVAL"==t.noticeActiveType?s("n-check",{on:{closeDialog:t.switchNoticeDialog}}):t._e(),t._v(" "),"FOLLOWED"==t.noticeActiveType?s("n-notice",{on:{closeDialog:t.switchNoticeDialog}}):t._e()],1)])])],1)},n=[],a=s("a34a"),r=s.n(a),o=s("dc96"),c=s("cf05"),l=s.n(c),u=s("f3e4"),v=s("8c58"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-disabled":t.busy}},[t._l(t.list,(function(e,i){return s("li",{key:i},["NOTIFY"==t.msgType?s("div",{staticClass:"serve-msg"},[s("h3",{staticClass:"title"},[t._v(t._s(e.title))]),t._v(" "),s("p",{staticClass:"time"},[t._v("\n        "+t._s(t.$formatDate(e.publishTime,"yyyy月MM月dd日 HH:mm"))+"\n      ")]),t._v(" "),s("p",{staticClass:"tips"},[t._v(t._s(e.content.description))]),t._v(" "),t._l(e.content.details,(function(e,i){return s("dl",{directives:[{name:"show",rawName:"v-show",value:e.v,expression:"item2.v"}],key:i,staticClass:"content"},[s("dt",[t._v(t._s(e.k)+"：")]),t._v(" "),s("dd",{domProps:{innerHTML:t._s(e.v)}})])})),t._v(" "),s("p",{staticClass:"tips"},[t._v(t._s(e.content.ignorant))]),t._v(" "),e.content.detailJump&&e.content.detailJump.detailedId?s("p",{staticClass:"more",on:{click:function(s){return t.toDetail(e.content.detailJump)}}},[s("span",[t._v("详情")]),t._v(" "),s("svg-icon",{attrs:{"icon-class":"right"}})],1):t._e()],2):s("div",{staticClass:"focus-msg"},[s("div",{staticClass:"time"},[t._v(t._s(t._f("converDate")(e.publishTime)))]),t._v(" "),s("div",{staticClass:"main"},[s("el-image",{staticClass:"avatar",attrs:{src:e.content.image,type:"preview"}},[s("img",{attrs:{slot:"error",src:t.housePlaceholder},slot:"error"})]),t._v(" "),s("div",{staticClass:"content"},[s("h3",{staticClass:"head"},[t._v(t._s(e.title))]),t._v(" "),s("div",{staticClass:"body"},[s("p",[t._v(t._s(e.content.subTitle))]),t._v(" "),s("p",[t._v("\n              "+t._s(e.content.description)+"\n            ")])])])],1)])])})),t._v(" "),t.isEmpty&&!t.list.length?s("li",{staticClass:"loading flex-center"},[s("span",[t._v("----- 暂无消息 -----")])]):s("li",{staticClass:"loading"},[t.isEmpty?s("span",[t._v("----- 暂无更多 -----")]):s("span",[s("i",{staticClass:"el-icon-loading"}),t._v(" 加载中~")])])],2)},f=[],h=s("c443"),g=s("c1ed"),p=s.n(g);function m(t,e,s,i,n,a,r){try{var o=t[a](r),c=o.value}catch(l){return void s(l)}o.done?e(c):Promise.resolve(c).then(i,n)}function A(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var a=t.apply(e,s);function r(t){m(a,i,n,r,o,"next",t)}function o(t){m(a,i,n,r,o,"throw",t)}r(void 0)}))}}var w={props:{msgType:{type:String,default:""}},data:function(){return{housePlaceholder:p.a,queryData:{messageType:"NOTIFY",ltMessageId:null,limit:10},busy:!0,isEmpty:!1,list:[]}},computed:{noticeActiveType:function(){return this.$store.state.settings.noticeActiveType},toggleNoticeDialog:function(){return this.$store.state.settings.toggleNoticeDialog}},watch:{noticeActiveType:function(t){this.queryData.messageType=t,this.list=[],this.getMessage()},toggleNoticeDialog:{immediate:!0,handler:function(t){t&&(this.list=[],this.getMessage())}}},created:function(){this.list=[],this.queryData.messageType=this.noticeActiveType,this.getMessage()},methods:{toDetail:function(t){var e=this,s=t.detailedId,i=t.detailedType,n=t.tag,a={HOUSE:"/work/house/detail/".concat(s),COMMUNITY:"/work/house/communityDetail/".concat(s),ORDERDEAL:"/work/business/newHouse/dealDetail/".concat(s),VISIT_APPROVAL_LIST:"/work/business/newHouse/dealDetail/".concat(s)};this.$navigateTo({query:{title:n},path:a[i]}).then((function(){e.$emit("closeDialog")}))},getMessageCount:function(){var t=this;return A(r.a.mark((function e(){var s,i,n,a;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["c"])({readState:!1});case 2:s=e.sent,s&&(i=s.NOTIFY,n=s.APPROVAL,a=s.FOLLOWED,t.$store.commit("settings/SET_UNREAD_MSG_COUNT",{NOTIFY:i,APPROVAL:n,FOLLOWED:a}));case 4:case"end":return e.stop()}}),e)})))()},getMessage:function(){var t=this;return A(r.a.mark((function e(){var s;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.queryData.ltMessageId=t.list[t.list.length-1]?t.list[t.list.length-1].id:null,t.busy=!0,e.next=4,Object(h["b"])(t.queryData);case 4:s=e.sent,s?(t.list=t.list.concat(s),t.getMessageCount(),(0==s.length||s.length<5)&&(t.busy=!1,t.isEmpty=!0),setTimeout((function(){t.busy=!1}),300)):t.isEmpty=!0;case 6:case"end":return e.stop()}}),e)})))()},loadMore:function(){this.busy||this.getMessage()}}},_=w,b=(s("b828"),s("2877")),C=Object(b["a"])(_,d,f,!1,null,"24b25eaf",null),y=C.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-check-wrap"},[s("el-tabs",{staticClass:"notice-check-tabs",attrs:{type:"card"},on:{"tab-click":t.tabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabs,(function(e){return s("el-tab-pane",{key:e.value,attrs:{label:e.label,name:e.value}},[s("el-badge",{staticClass:"label",attrs:{slot:"label",value:t.unreadCount&&0==e.value?t.unreadCount:null},slot:"label"},[t._v(t._s(e.label))]),t._v(" "),s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-disabled":"busy"}},[t._l(t.list,(function(e,i){return s("check-cell",{key:i,attrs:{options:e},on:{cellClick:function(e){return t.cellClick(i)}}})})),t._v(" "),t.isEmpty&&!t.list.length?s("li",{staticClass:"loading flex-center"},[s("span",[t._v("----- 暂无消息 -----")])]):s("li",{staticClass:"loading"},[t.isEmpty?s("span",[t._v("----- 暂无更多 -----")]):s("span",[s("i",{staticClass:"el-icon-loading"}),t._v(" 加载中~")])])],2)],1)})),1),t._v(" "),t.toggleDetailPupop?s("div",{staticClass:"detail"},[s("div",{staticClass:"head flex"},[s("div",{staticClass:"back",on:{click:function(e){t.toggleDetailPupop=!1}}},[s("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),s("h2",{staticClass:"title"},[t._v(t._s(t.itemTypes[t.cellDetail.content.approvalType]))])]),t._v(" "),s("div",{staticClass:"user-info flex"},[s("el-image",{staticClass:"avatar",attrs:{fit:"cover",src:t.cellDetail.content.auditee.portrait}},[s("img",{attrs:{slot:"error",src:t.avatar},slot:"error"})]),t._v(" "),s("div",{staticClass:"text flex-between"},[s("div",[s("h3",{staticClass:"name"},[t._v(t._s(t.cellDetail.content.auditee.username))]),t._v(" "),s("p",[t._v("\n            "+t._s(t.cellDetail.content.auditee.positionName)+"\n            "+t._s(t.cellDetail.content.auditee.storeName)+t._s(t.cellDetail.content.auditee.groupName)+"\n          ")])]),t._v(" "),"WAIT_APPROVAL"==t.cellDetail.content.approvalState?s("div",{staticClass:"status red"},[t._v("\n          待审批\n        ")]):t._e(),t._v(" "),"ADOPT"==t.cellDetail.content.approvalState?s("div",{staticClass:"status",style:{backgroundImage:"url("+t.resolveImg+")"}}):t._e(),t._v(" "),"REJECT"==t.cellDetail.content.approvalState?s("div",{staticClass:"status",style:{backgroundImage:"url("+t.rejectImg+")"}}):t._e()])],1),t._v(" "),s("div",{staticClass:"content"},t._l(t.cellDetail.content.details,(function(e,i){return s("dl",{key:i,staticClass:"flex-between"},[s("dt",[t._v(t._s(e.k))]),t._v(" "),s("dd",{directives:[{name:"converTxtToHTML",rawName:"v-converTxtToHTML",value:t.cellDetail.content.resourceMap,expression:"cellDetail.content.resourceMap"}],class:{"link-btn2":e.j&&e.j.detailedId},on:{click:function(s){return t.toDetail(e.j)}}},[s("span",[t._v(" "+t._s(e.v))])])])})),0),t._v(" "),s("div",{staticClass:"timeline"},[s("el-timeline",t._l(t.cellDetail.content.approvalItemList,(function(e,i){return s("el-timeline-item",{key:i},[s("div",{staticClass:"avatar-wrap"},[s("el-image",{staticClass:"avatar",attrs:{fit:"cover",src:e.portrait}},[s("img",{attrs:{slot:"error",src:t.avatar},slot:"error"})]),t._v(" "),"WAIT_APPROVAL"!=e.approvalState?s("svg-icon",{attrs:{"icon-class":"ok"}}):t._e()],1),t._v(" "),s("div",{staticClass:"info"},[s("h3",{staticClass:"flex-between"},[s("p",[t._v("\n                "+t._s(t.operatorTypes[e.operatorType])+"\n                "),i>0?s("span",{staticClass:"status",class:{red:"REJECT"==e.approvalState}},[t._v("("+t._s(t.status[e.approvalState])+")")]):t._e()]),t._v(" "),s("p",{staticClass:"time"},[t._v(t._s(t._f("converDate")(e.triggerTime)))])]),t._v(" "),s("p",{staticClass:"name"},[t._v(t._s(e.username))]),t._v(" "),i==t.cellDetail.content.approvalItemList.length-1&&t.cellDetail.content.reason?s("p",{staticClass:"note"},[t._v("\n              "+t._s(t.cellDetail.content.reason)+"\n            ")]):t._e()])])})),1)],1),t._v(" "),"WAIT_APPROVAL"==t.cellDetail.content.approvalState&&0==t.activeName?s("el-button-group",{staticClass:"operate mb20"},[s("el-button",{on:{click:function(e){t.toggleRejectDialog=!0}}},[t._v("驳回")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.approval("ADOPT")}}},[t._v("同意")])],1):t._e()],1):t._e(),t._v(" "),s("window2",{staticClass:"reject-dialog",attrs:{width:"310px",hasFooter:!1},model:{value:t.toggleRejectDialog,callback:function(e){t.toggleRejectDialog=e},expression:"toggleRejectDialog"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("\n      驳回理由\n    ")]),t._v(" "),s("div",{attrs:{slot:"main"},slot:"main"},[s("el-input",{staticClass:"fm-textarea",attrs:{type:"textarea",placeholder:"驳回理由",rows:"5"},model:{value:t.checkData.reason,callback:function(e){t.$set(t.checkData,"reason",e)},expression:"checkData.reason"}}),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{size:"small",type:"primary"},on:{click:function(e){return t.approval("REJECT")}}},[t._v("提交")])],1)])],1)},I=[],O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"cell",on:{click:t.cellClick}},[s("el-image",{staticClass:"avatar",attrs:{src:t.options.content.approvalItemList&&t.options.content.approvalItemList[0].portrait}},[s("img",{attrs:{slot:"error",src:t.avatar},slot:"error"})]),t._v(" "),s("div",{directives:[{name:"converTxtToHTML",rawName:"v-converTxtToHTML",value:t.options.content.resourceMap,expression:"options.content.resourceMap"}],staticClass:"content"},[s("div",{staticClass:"head flex-between"},[s("h3",{staticClass:"name"},[t._v(t._s(t.options.title))]),t._v(" "),s("span",[t._v(t._s(t._f("converDate")(t.options.publishTime)))])]),t._v(" "),t._l(t.options.content.details,(function(e,i){return s("dl",{key:i,staticClass:"info-cell"},[s("dt",[t._v(t._s(e.k)+"：")]),t._v(" "),s("dd",[t._v("\n        "+t._s(e.v)+"\n      ")])])})),t._v(" "),s("p",{staticClass:"status"},["WAIT_APPROVAL"==t.options.content.approvalState?s("span",{staticClass:"red"},[t._v("待审批")]):t._e(),t._v(" "),"ADOPT"==t.options.content.approvalState?s("span",{staticClass:"green"},[t._v("通过审核")]):t._e(),t._v(" "),"REJECT"==t.options.content.approvalState?s("span",{staticClass:"orange"},[t._v("驳回")]):t._e()])],2)],1)},E=[],L=s("1195"),k=s.n(L),D={props:{options:{type:Object,default:function(){return{conrent:{details:[]}}}}},data:function(){return{avatar:k.a,statusTypes:{WAIT_APPROVAL:"待审批",ADOPT:"通过",REJECT:"驳回"}}},created:function(){},methods:{cellClick:function(){this.$emit("cellClick")}}},x=D,P=(s("e099"),Object(b["a"])(x,O,E,!1,null,"d4867c8e",null)),M=P.exports,N=s("b964"),S=s("779e"),R=s.n(S),j=s("8604"),V=s.n(j);function B(t,e,s,i,n,a,r){try{var o=t[a](r),c=o.value}catch(l){return void s(l)}o.done?e(c):Promise.resolve(c).then(i,n)}function $(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var a=t.apply(e,s);function r(t){B(a,i,n,r,o,"next",t)}function o(t){B(a,i,n,r,o,"throw",t)}r(void 0)}))}}var Q={components:{CheckCell:M,Window2:N["a"]},data:function(){return{avatar:k.a,rejectImg:R.a,resolveImg:V.a,activeName:0,queryData:{hasRead:!1,messageType:"APPROVAL",ltMessageId:null,limit:10},checkData:{approvalAction:"ADOPT",reason:"",notifyId:null},tabs:[{label:"待我审核",value:0},{label:"我已审批",value:1},{label:"我发起的",value:2}],busy:!0,isEmpty:!1,list:[],unreadCount:0,cellDetail:{content:{details:{},auditee:{},approvalItemList:{}}},toggleDetailPupop:!1,toggleRejectDialog:!1,operatorTypes:{SENDER:"发起审批",REVIEWER:"审批人"},itemTypes:{KEY_APPROVAL:"钥匙审批",SEAL_APPROVAL:"封盘审批",UNSEAL_APPROVAL:"解封审批",ENTRUST_AGREEMENT_APPROVAL:"委托协议",MAINTAIN_SPARE_PART_APPROVAL:"维护备件",APPLY_EXPLORATION_APPROVAL:"实勘"},status:{WAIT_APPROVAL:"待审批",ADOPT:"通过",REJECT:"驳回"}}},computed:{toggleNoticeDialog:function(){return this.$store.state.settings.toggleNoticeDialog},noticeActiveType:function(){return this.$store.state.settings.noticeActiveType}},watch:{toggleNoticeDialog:{immediate:!0,handler:function(t){t&&this.getMessage(!0)}}},methods:{toDetail:function(t){var e=this;if(t){var s=t.detailedId,i=t.detailedType,n=t.tag,a="detail";"COMMUNITY"==i&&(a="communityDetail"),this.$navigateTo({query:{title:n},path:"/work/house/".concat(a,"/").concat(s)}).then((function(){e.$emit("closeDialog")}))}},tabClick:function(t){var e=t.name;3==e||(this.queryData.hasRead=!!e),this.getMessage(!0)},approval:function(t){var e=this;return $(r.a.mark((function s(){var i;return r.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.checkData.approvalAction=t,e.checkData.notifyId=e.cellDetail.id,s.next=4,Object(h["a"])(e.checkData);case 4:i=s.sent,i&&(e.$showSuccess("操作成功"),e.toggleRejectDialog=!1,e.toggleDetailPupop=!1,e.checkData.reason="",e.getMessage(!0),e.getMessageCount(),e.$root.$emit("unreadMsg"));case 6:case"end":return s.stop()}}),s)})))()},getMessageCount:function(){var t=this;return $(r.a.mark((function e(){var s,i,n,a;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["c"])({readState:!1});case 2:s=e.sent,s&&(t.unreadCount=s.APPROVAL,i=s.NOTIFY,n=s.APPROVAL,a=s.FOLLOWED,t.$store.commit("settings/SET_UNREAD_MSG_COUNT",{NOTIFY:i,APPROVAL:n,FOLLOWED:a}));case 4:case"end":return e.stop()}}),e)})))()},getMessage:function(t){var e=this;return $(r.a.mark((function s(){var i,n,a;return r.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return t&&(e.list=[]),i=e.list.length-1,e.list[i]?e.queryData.ltMessageId=e.list[i].id:e.queryData.ltMessageId=null,e.busy=!0,n=2==e.activeName?h["e"]:h["b"],s.next=7,n(e.queryData);case 7:a=s.sent,a?(e.list=e.list.concat(a),e.getMessageCount(),(0==a.length||a.length<5)&&(e.isEmpty=!0),setTimeout((function(){e.busy=!1}),300)):e.isEmpty=!0;case 9:case"end":return s.stop()}}),s)})))()},loadMore:function(){this.busy||(2==this.activeName?this.getMessage(!1):this.getMessage())},cellClick:function(t){this.cellDetail=this.list[t],this.toggleDetailPupop=!0}}},F=Q,W=(s("a833"),s("6445"),Object(b["a"])(F,T,I,!1,null,"0dcb036b",null)),Y=W.exports,U=s("b383"),G=s.n(U),z=s("4360");function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function J(t,e,s){return e&&Z(t.prototype,e),s&&Z(t,s),t}var X=function(){function t(e){var s=e.host,i=void 0===s?window.location.host:s,n=e.path,a=void 0===n?"":n,r=e.params,o=e.handleOnmessage,c=void 0===o?function(){}:o,l=e.timeout,u=void 0===l?1e4:l;H(this,t);var v=z["a"].state.user,d=v.token,f=v.userId;this.host=i,this.path=a,this.params=r||{token:d,userId:f},this.handleOnmessage=c,this.timeout=u,this.timer=null,this.ws=null,this.flag=!0,this.count=0,this.createWebsocket()}return J(t,[{key:"createWebsocket",value:function(){var t="ws",e="";this.host="pcnapi.fangmao.com:10000","pcn.fangmao.com"!=location.hostname&&(this.host="101.37.129.89:30012"),"https:"==document.location.protocol&&(t="wss"),t="wss",this.host="pcnapi.fangmao.com",e="".concat(t,"://").concat(this.host).concat(this.path,"?").concat(G.a.stringify(this.params)),this.ws=new WebSocket(e),this.initEvents()}},{key:"initEvents",value:function(){var t=this;this.ws.onclose=function(){t.count++,t.reconnect()},this.ws.error=function(){t.count++,t.reconnect()},this.ws.onopen=function(){t.reset()},this.ws.onmessage=function(e){t.reset(),t.handleOnmessage(e)}}},{key:"reconnect",value:function(){var t=this;this.flag&&this.count<=5?setTimeout((function(){t.createWebsocket()}),1e4):clearTimeout(this.timer)}},{key:"reset",value:function(){clearTimeout(this.timer),this.heartbeat()}},{key:"heartbeat",value:function(){var t=this;this.timer=setInterval((function(){t.flag&&1==t.ws.readyState&&t.ws.send("ping")}),this.timeout)}},{key:"close",value:function(){this.flag=!1,this.ws.close()}},{key:"send",value:function(t){this.ws.send(t)}}]),t}();function q(t,e,s,i,n,a,r){try{var o=t[a](r),c=o.value}catch(l){return void s(l)}o.done?e(c):Promise.resolve(c).then(i,n)}function K(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var a=t.apply(e,s);function r(t){q(a,i,n,r,o,"next",t)}function o(t){q(a,i,n,r,o,"throw",t)}r(void 0)}))}}function tt(t,e){var s;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=et(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,o=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return r=t.done,t},e:function(t){o=!0,a=t},f:function(){try{r||null==s.return||s.return()}finally{if(o)throw a}}}}function et(t,e){if(t){if("string"===typeof t)return st(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?st(t,e):void 0}}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var it=60,nt={tel:"",vcode:""},at={components:{TabsLine:o["default"],FmNotification:v["a"],NNotice:y,NCheck:Y},data:function(){return{avatar:k.a,gender:["未知","男","女"],tabs:["工作台","业务配置"],userFlag:!1,imagecropperShow:!1,telFlag:!1,telActive:0,telForm:JSON.parse(JSON.stringify(nt)),vText:"获取验证码",timer:null,time:it,smsing:!1,imgUrl:"",cropperUrl:"",cropFlag:!0,uploadFlag:!0,tabIndex:0,siteId:null,userImg:null,ws:null,hasUnreadMsg:!1}},computed:{logo:function(){return this.userInfo.companyLogo||l.a},isHide:function(){return"/enrollment"==this.$route.path},dynamicMenu:function(){return this.$Storage.get("fm-menu")},token:function(){return this.$store.state.user.token},userId:function(){return this.$store.state.user.userId},userInfo:function(){return this.$store.state.settings.userInfo},site:function(){return this.$store.state.settings.site},tagsView:function(){return this.$store.state.tagsView.visitedViews},toggleNoticeDialog:function(){return this.$store.state.settings.toggleNoticeDialog},noticeActiveType:function(){return this.$store.state.settings.noticeActiveType},unreadMsgCount:function(){return this.$store.state.settings.unreadMsgCount}},watch:{unreadMsgCount:function(t){this.toggleUnreadBadge(t)}},created:function(){var t=this;this.getUserInfo(),this.userImg=this.userInfo.avatarPath,this.siteId=this.site.id,this.msgSocket(),this.getMessageCount(),this.$root.$on("getUserImg",(function(e){t.userImg=e}))},mounted:function(){var t=this;window.onbeforeunload=function(){Object(u["h"])(t.userId),Object(u["g"])(t.token);var e,s=tt(t.tagsView);try{for(s.s();!(e=s.n()).done;){var i=e.value;i.path!=t.$route.path&&sessionStorage.removeItem("tab".concat(i.path))}}catch(n){s.e(n)}finally{s.f()}return null}},methods:{switchNoticeDialog:function(t){!0===t?this.$store.commit("settings/SET_NOTICE_DIALOG_STATUS",!0):this.$store.commit("settings/SET_NOTICE_DIALOG_STATUS",!1)},toUserCenter:function(){this.$navigateTo("/home/userInfo")},toggleUnreadBadge:function(t){t.APPROVAL+t.FOLLOWED+t.NOTIFY>0?this.hasUnreadMsg=!0:this.hasUnreadMsg=!1,t.APPROVAL>0&&(this.hasUnreadMsg=t.APPROVAL)},getMessageCount:function(){var t=this;return K(r.a.mark((function e(){var s,i,n,a;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["c"])({readState:!1});case 2:s=e.sent,s&&(t.toggleUnreadBadge(s),i=s.NOTIFY,n=s.APPROVAL,a=s.FOLLOWED,t.$store.commit("settings/SET_UNREAD_MSG_COUNT",{NOTIFY:i,APPROVAL:n,FOLLOWED:a}));case 4:case"end":return e.stop()}}),e)})))()},msgSocket:function(){var t=this;this.ws=new X({path:"/notify",handleOnmessage:function(e){try{var s=JSON.parse(e.data),i=s.messageType;if("APPROVAL"==i&&(i="待我审核"),"NOTIFY"==i&&(i="服务通知"),t.getMessageCount(),"FOLLOWED"==i)return;t.$notify({title:i,message:"【".concat(s.title,"】").concat(s.content.description?s.content.description:""),position:"bottom-left",showClose:!0,duration:6e4})}catch(n){return n}}}),this.$store.commit("user/SET_WS",this.ws)},changeTab:function(t){var e,s=null,i=tt(this.dynamicMenu[t].children[0].children);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(3!=n.status&&n.meta.permission){s=n.menuPage;break}}}catch(o){i.e(o)}finally{i.f()}var a=this.$store.state.tagsView.visitedViews,r=a.find((function(t){return t.path==s}));r?this.$navigateTo(r,!1):this.$navigateTo(s)},jump:function(t){switch(t){case 0:this.$navigateTo({path:"/"});break;case 1:this.$navigateTo({path:"/store/index"});break;default:this.$navigateTo({path:"/404"})}},logout:function(){this.$store.dispatch("user/logout")},getUserInfo:function(){var t=this;return K(r.a.mark((function e(){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("settings/getUserInfo");case 2:return e.next=4,t.$store.dispatch("settings/getUserMenu");case 4:case"end":return e.stop()}}),e)})))()}}},rt=at,ot=(s("1509"),s("3362"),Object(b["a"])(rt,i,n,!1,null,"17f8c40a",null));e["default"]=ot.exports},"779e":function(t,e,s){t.exports=s.p+"img/reject.e00a2cf2.png"},"7ff8":function(t,e,s){"use strict";var i=s("b810"),n=s.n(i);n.a},8604:function(t,e,s){t.exports=s.p+"img/resolve.69a090d7.png"},"8c58":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notification"},[s("ul",{staticClass:"list"},t._l(t.msgTabs,(function(e,i){return s("li",{key:i,class:["item","type"+t.msgTypeIndexObj[e.name],e.name==t.noticeActiveType&&t.hasClickStyle?"active":""],style:t.rowStyle,on:{click:function(s){return t.msgTypeClick(e.name,i)}}},["APPROVAL"==e.name?s("el-badge",{attrs:{value:t.unreadMsgCount[e.name]||null}},[s("div",{staticClass:"icon"},[s("svg-icon",{attrs:{"icon-class":e.icon}})],1)]):s("el-badge",{attrs:{"is-dot":!!t.unreadMsgCount[e.name]}},[s("div",{staticClass:"icon",style:{backgroundColor:e.color}},[s("svg-icon",{attrs:{"icon-class":e.icon}})],1)]),t._v(" "),s("div",{staticClass:"summary"},[s("div",{staticClass:"title"},[s("h3",[t._v(t._s(e.label))]),t._v(" "),t.newMessages[t.msgTypeIndexObj[e.name]][0]?s("span",{staticClass:"time",style:"max-width:"+t.maxW+"px"},[t._v(t._s(t._f("converDate")(t.newMessages[t.msgTypeIndexObj[e.name]][0].publishTime)))]):t._e()]),t._v(" "),t.newMessages[t.msgTypeIndexObj[e.name]][0]?s("p",{staticClass:"desc"},[t._v("\n          "+t._s(t.newMessages[t.msgTypeIndexObj[e.name]][0].title)+"\n        ")]):t._e()])],1)})),0)])},n=[],a=s("a34a"),r=s.n(a),o=s("c443");function c(t,e,s,i,n,a,r){try{var o=t[a](r),c=o.value}catch(l){return void s(l)}o.done?e(c):Promise.resolve(c).then(i,n)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var a=t.apply(e,s);function r(t){c(a,i,n,r,o,"next",t)}function o(t){c(a,i,n,r,o,"throw",t)}r(void 0)}))}}var u={props:{hasClickStyle:{type:Boolean,default:!0},rowStyle:{type:Object,default:function(){}},maxW:{type:Number,default:80}},data:function(){return{newMessages:[[{}],[{}],[{}]],msgTabs:[],msgTabs2:[{name:"NOTIFY",sort:2,icon:"bell",label:"服务通知",bgColor:"#67c23a"},{name:"APPROVAL",sort:1,icon:"role",label:"审批助手",bgColor:"#409eff"},{name:"FOLLOWED",sort:0,icon:"love3",label:"我关注的",bgColor:"#e6a23c"}],msgTypeIndexObj:{NOTIFY:0,APPROVAL:1,FOLLOWED:2},msgType:"NOTIFY",hasRead:[!0,!0,!0]}},computed:{unreadMsgCount:function(){return this.$store.state.settings.unreadMsgCount},noticeActiveType:function(){return this.$store.state.settings.noticeActiveType}},watch:{unreadMsgCount:function(t,e){JSON.stringify(t)!=JSON.stringify(e)&&(this.getReadStatusType(t),this.getMessages())}},created:function(){var t=this;return l(r.a.mark((function e(){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getMessageCount();case 2:return t.getReadStatusType(t.unreadMsgCount),e.next=5,t.getMessages();case 5:t.noticeActiveType||t.$store.commit("settings/SET_NOTICE_ACTIVE_TYPE",t.msgTabs[0].name);case 6:case"end":return e.stop()}}),e)})))()},methods:{getMessageCount:function(){var t=this;return l(r.a.mark((function e(){var s,i,n,a;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["c"])({readState:!1});case 2:return s=e.sent,s&&(i=s.NOTIFY,n=s.APPROVAL,a=s.FOLLOWED,t.$store.commit("settings/SET_UNREAD_MSG_COUNT",{NOTIFY:i,APPROVAL:n,FOLLOWED:a})),e.abrupt("return",Promise.resolve(s));case 5:case"end":return e.stop()}}),e)})))()},getReadStatusType:function(t){for(var e in this.hasRead=[!0,!0,!0],t)if(0!=t[e])switch(e){case"NOTIFY":this.hasRead[0]=!1;break;case"APPROVAL":this.hasRead[1]=!1;break;case"FOLLOWED":this.hasRead[2]=!1;break}},getMessages:function(){var t=this;return l(r.a.mark((function e(){var s,i,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={messageTypes:"NOTIFY,APPROVAL,FOLLOWED",hasRead:t.hasRead.toString(),limit:1},e.next=3,Object(o["d"])(s);case 3:if(i=e.sent,!i){e.next=11;break}return t.newMessages=i,n=t.$cloneObj(t.msgTabs2),i.forEach((function(e){if(e&&e[0]){var s=t.msgTypeIndexObj[e[0].messageType];n[s].sort=Date.parse(new Date(e[0].publishTime))}})),t.msgTabs=n.sort((function(t,e){return e.sort-t.sort})),t.$store.commit("settings/SET_NOTICE_ACTIVE_TYPE",t.noticeActiveType),e.abrupt("return",Promise.resolve(t.msgTabs));case 11:case"end":return e.stop()}}),e)})))()},msgTypeClick:function(t){this.$store.commit("settings/SET_NOTICE_DIALOG_STATUS",!0),this.$store.commit("settings/SET_NOTICE_ACTIVE_TYPE",t)}}},v=u,d=(s("1903"),s("2877")),f=Object(d["a"])(v,i,n,!1,null,"7c67aec0",null);e["a"]=f.exports},9133:function(t,e,s){"use strict";var i=s("3c5d"),n=s.n(i);n.a},"9bf2":function(t,e,s){},"9cc0":function(t,e,s){},"9fe9":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("footer",{staticClass:"footer"},[t._v(t._s(t.msg))])},n=[],a={data:function(){return{msg:"copyright © 2019 四川熊猫房猫科技有限公司"}}},r=a,o=(s("527f"),s("2877")),c=Object(o["a"])(r,i,n,!1,null,"830d7da8",null);e["a"]=c.exports},a833:function(t,e,s){"use strict";var i=s("fb24"),n=s.n(i);n.a},b810:function(t,e,s){},b828:function(t,e,s){"use strict";var i=s("c878"),n=s.n(i);n.a},b964:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"el-fade-in"}},[t.showWindow?s("div",{staticClass:"bg",attrs:{value:t.value}},[s("div",{staticClass:"window transition-box",style:"width:"+t.width+"px"},[s("div",{staticClass:"window-title"},[s("p",{staticClass:"flex-between"},[t._t("title"),t._v(" "),s("svg-icon",{staticClass:"icon pointer",attrs:{"icon-class":"close"},on:{click:function(e){t.showWindow=!1}}})],2)]),t._v(" "),s("div",{staticClass:"window-main"},[t._t("main")],2),t._v(" "),t.hasFooter?s("div",{staticClass:"window-footer"},[t._t("footer")],2):t._e()])]):t._e()])},n=[],a={props:{hasFooter:{type:Boolean,default:!1},value:{type:Boolean,default:!1},width:{type:Number,default:580}},data:function(){return{showWindow:!1}},watch:{value:function(t){this.showWindow=t},showWindow:function(t){this.$emit("input",t)}}},r=a,o=(s("5e1f"),s("29e1"),s("2877")),c=Object(o["a"])(r,i,n,!1,null,"21c550fb",null);e["a"]=c.exports},bcce:function(t,e,s){},bfdb:function(t,e,s){"use strict";var i=s("4b84"),n=s.n(i);n.a},c19f:function(t,e,s){},c1ed:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAEsCAIAAABi1XKVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTI1NkI3NjRFNDk4MTFFOUE5NDZBQjJEMkU4QzU3MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTI1NkI3NjVFNDk4MTFFOUE5NDZBQjJEMkU4QzU3MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCRTc4RTg2M0UzRTMxMUU5QTk0NkFCMkQyRThDNTczNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRTc4RTg2NEUzRTMxMUU5QTk0NkFCMkQyRThDNTczNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn9FbOEAAAb5SURBVHja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"},c443:function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"d",(function(){return a})),s.d(e,"c",(function(){return r})),s.d(e,"e",(function(){return o})),s.d(e,"a",(function(){return c}));var i=s("b775"),n=function(t){return Object(i["a"])({url:"/api/v1/message/message",method:"get",data:t})},a=function(t){return Object(i["a"])({url:"/api/v1/message/messages",method:"get",data:t})},r=function(t){return Object(i["a"])({url:"/api/v1/message/count",method:"get",data:t})},o=function(t){return Object(i["a"])({url:"/api/v1/message/triggeredApprovalMessage",method:"get",data:t})},c=function(t){return Object(i["a"])({url:"/api/v1/fm/approval/handle",params:t})}},c878:function(t,e,s){},cf05:function(t,e,s){t.exports=s.p+"img/logo.902edb02.png"},d535:function(t,e,s){},dc96:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line"},[s("div")])}],a=(s("f041"),s("2877")),r={},o=Object(a["a"])(r,i,n,!1,null,"e2609534",null);e["default"]=o.exports},ddcd:function(t,e,s){},e099:function(t,e,s){"use strict";var i=s("0e73"),n=s.n(i);n.a},f041:function(t,e,s){"use strict";var i=s("1142"),n=s.n(i);n.a},fb24:function(t,e,s){}}]);